<!-- MAIN PRODUCT PAGE -->
@if (!loading) {
  @if (product; as p) {
  <section
    class="dp-page"
  >
    <!-- HERO -->
    <div class="dp-hero">
      <div class="dp-inner">
        <div class="dp-hero-main">
          <p class="dp-eyebrow">Digital product</p>

          <h1 class="dp-title">{{ p.title }}</h1>

          <p class="dp-subtitle">
            {{ p.short_description }}
          </p>

          @if (p.bullets?.length) {
            <ul class="dp-highlights">
              @for (item of p.bullets; track $index) {
                <li>
                  {{ item }}
                </li>
              }
            </ul>
          }

          <div class="dp-hero-footer">
            <div class="dp-actions">
              <!-- <button
                type="button"
                class="btn btn-primary"
                (click)="onBuy()"
                [disabled]="buying"
              >
                {{ buying ? 'Redirecting…' : 'Get this digital product' }}
              </button> -->

              <a routerLink="/digital-products" class="btn btn-ghost">
                Back to all digital products
              </a>
            </div>
          </div>
        </div>

        <div class="dp-hero-card">
          <div class="dp-hero-image">
            <img [src]="p.thumbnail" [alt]="p.title" />
          </div>

          <div class="dp-hero-meta">
            <span class="dp-meta-line">
              Digital download · instant access · no subscription
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- WHAT'S INSIDE -->
    @if (p.whatsInside?.length) {
      <section class="dp-section">
        <div class="dp-inner">
          <div class="dp-section-header">
            <h2 class="dp-section-title">What’s inside</h2>
            <p class="dp-section-subtitle">
              Everything you get when you purchase this digital product.
            </p>
          </div>

          <div class="dp-inside-grid">
            @for (item of p.whatsInside; track $index) {
              <article class="dp-inside-card">
                <h3 class="dp-inside-title">{{ item }}</h3>
                <p class="dp-inside-text">
                  A focused block designed to plug directly into your workflow.
                </p>
              </article>
            }
          </div>
        </div>
      </section>
    }

    <!-- DETAILS -->
    <section class="dp-section">
      <div class="dp-inner">
        <div class="dp-details">
          <h2 class="dp-section-title">How this digital product helps you</h2>
          <p class="dp-details-text">
            {{ p.description }}
          </p>
        </div>
      </div>
    </section>

    <!-- FAQ (static text, only references p.title once) -->
    @if (p.faqs?.length) {
      <section class="dp-section dp-faq">
        <div class="dp-inner">
          <div class="dp-section-header">
            <h2 class="dp-section-title">Frequently asked questions</h2>
          </div>

          <div class="dp-faq-grid">
            @for (faq of p.faqs; track $index) {
              <article class="dp-faq-item">
                <h3 class="dp-faq-q">{{ faq.q }}</h3>
                <p class="dp-faq-a">{{ faq.a }}</p>
              </article>
            }
          </div>
        </div>
      </section>
    }


    <!-- BOTTOM CTA -->
    <section class="dp-bottom-cta">
      <div class="dp-inner">
        <div class="dp-bottom-card">
          <div class="dp-bottom-text">
            <h2 class="dp-bottom-title">
              Ready to plug this into your workflow?
            </h2>
            <p class="dp-bottom-subtitle">
              Get instant access to {{ p.title }} and start using it today.
            </p>
          </div>

          <!-- <button
            type="button"
            class="btn btn-primary"
            (click)="onBuy()"
            [disabled]="buying"
          >
            {{ buying ? 'Redirecting…' : 'Get this digital product' }}
          </button> -->
        </div>
      </div>
    </section>
  </section>
  }
} @else {
  <!-- LOADING / NOT FOUND STATES -->
  <!-- LOADING / NOT FOUND STATES -->
  @if (loading) {
    <section class="dp-page">
      <div class="dp-inner dp-not-found">
        <h1>Loading digital product…</h1>
      </div>
    </section>
  } @else {
    <section class="dp-page">
      <div class="dp-inner dp-not-found">
        <h1>Digital product not found.</h1>
        <a routerLink="/digital-products" class="btn btn-primary">
          Back to all digital products
        </a>
      </div>
    </section>
  }
}
