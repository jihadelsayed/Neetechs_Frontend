<div class="section" [attr.id]="sectionId">
  <h4>{{ section.title }}</h4>
  <p>{{ section.content }}</p>

  @if (section.code) {
    <pre>
      <code>{{ section.code }}</code>
      <button class="copy-btn" (click)="copyToClipboard(section.code)">Copy</button>
    </pre>
  }

  <!-- Math Stepper -->
<!-- ✅ STEP-BY-STEP Math -->
@if (section.steps?.length) {
  <div class="math-box">
    <div class="stepper">
      <div *ngFor="let step of section.steps; let i = index">
        @if (i <= stepIndex) {
          <div class="math-box">
            <app-katex [expression]="step.math"></app-katex>
          </div>
        }
      </div>
      <button (click)="next.emit()" [disabled]="stepIndex >= section.steps.length - 1">
        ▶️ Next Step
      </button>
    </div>
  </div>
}

<!-- ✅ Static Full Math (no stepper) -->
@if (section.math && !section.steps?.length) {
  <div class="math-box">
    <app-katex [expression]="section.math"></app-katex>
  </div>
}


  <!-- Chart -->
  @if (section.graph) {
    <ngx-charts-line-chart
      [results]="section.graph"
      [scheme]="colorScheme"
      [xAxis]="true"
      [yAxis]="true"
      [legend]="true"
      [showXAxisLabel]="true"
      [showYAxisLabel]="true"
      [xAxisLabel]="section.graph.xLabel || 'X'"
      [yAxisLabel]="section.graph.yLabel || 'Y'"
      [autoScale]="true"
      style="width: 100%; height: 400px">
    </ngx-charts-line-chart>
  }
</div>
